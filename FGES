#FGES Enrichment Score Analysis README
This R script performs enrichment score analysis on a single-cell RNA-sequencing dataset using the Seurat and dittoSeq packages. The script calculates enrichment scores for various gene sets related to immune cell types, tumor microenvironment, and tumor proliferation.
Dependencies
The script requires the following R packages:

escape
Seurat
dittoSeq
ggplot2
dplyr
tibble
tidyr
patchwork
pheatmap

Make sure to install these packages before running the script.
Input Data
The script reads an RDS file containing a Seurat object named "Pdac_updated.rds" located at "/Users/akhaliq/Desktop/data_for analysis/st_data/". Make sure to update the file path if necessary.
Gene Sets
The script defines a list of gene sets related to various biological processes and cell types. These gene sets are stored in the gene.sets variable and include:

Angiogenesis
Antitumor_cytokines
Bcells
Cancer_associated_fibroblasts
Checkpoint_molecules
Co_stimulatory_ligands
Co_stimulatory_receptors
Effector_cell_traffic
Effector_cells
Endothelium
Granulocyte_traffic
Immune_Suppression_by_Myeloid_cells
M1_signature
Macrophage_and_DC_traffic
Matrix
Matrix_remodeling
MHCI
MHCII
Myeloid_cells_traffic
Neutrophil_signature
NK_cells
Protumor_cytokines
Tcells
Th1_signature
Th2_signature
Treg
Treg_and_Th2_traffic
Tumor_proliferation_rate
Tumor_associated_Macrophages

Analysis Steps

The script reads the Seurat object and renames the "Spatial" assay to "RNA".
Enrichment scores are calculated using the enrichIt function from the dittoSeq package, using the defined gene sets and 1000 groups with 8 cores.
The enrichment scores are saved as an RDS file named "ES.rds".
The enrichment scores are converted into a tibble format and added to the Seurat object as a new assay named "Es".
The "Es" assay is scaled using the ScaleData function from Seurat.
The scaled data is assigned back to the "Es" assay.
The cluster identities are set based on the "cc_ischia_10" column of the Seurat object.
The Seurat object is renamed to "data".
A data frame is created containing the mean enrichment scores for each cluster and gene set.
The data frame is reshaped into a matrix format with clusters as rows and gene sets as columns.

Output
The script generates the following output:

An RDS file named "ES.rds" containing the enrichment scores.
A matrix named top_acts_mat containing the mean enrichment scores for each cluster and gene set.

Note: The script also includes some commented-out lines for subsetting the data and removing the original "pdac" object, which may be useful for specific analysis purposes.
